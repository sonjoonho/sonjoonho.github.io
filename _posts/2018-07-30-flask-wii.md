---
layout: post
title: Flask Wii
categories: Projects
---

<https://github.com/sonjoonho/flask-wii>

After stumbling across a neat little project called [web-riimote](https://github.com/konaraddio/web-riimote) by [konaraddio](https://github.com/konaraddio/) I thought it would be fun to recreate the features of this app from scratch, and without peeking at konaraddio's code. I had been using Flask a lot recently, so that was my tool of choice. 

Device orientation data is collected from the client (a mobile device) using the [Device Orientation API](https://developer.mozilla.org/en-US/docs/Web/API/Detecting_device_orientation).

{% highlight python %}
if (window.DeviceOrientationEvent) {
  /* alpha: direction according to the compass                         
   * beta: front-back tilt
   * gamma: left-right tilt
   */

  var alpha, beta, gamma;

  window.addEventListener("deviceorientation", function(eventData) {       

    // This is for zeroing the values. I think this is required on iOS but not Android or not idk
    // if (alpha_0 === null) {
    //   alpha_0 = eventData.alpha;
    // }

    // alpha = eventData.alpha - alpha_0;
    // beta = eventData.beta;
    // gamma = eventData.gamma;
    
    alpha = eventData.alpha;
    beta = eventData.beta;
    gamma = eventData.gamma;

    // if (alpha > 180) {
    //   alpha -= 360;
    // }
    

    console.log("("+alpha+","+beta+","+gamma+")");

    socket.emit("orientation", {room: room, angles: {alpha: alpha, beta: beta, gamma: gamma}
    });
                                                                        
  }, false);

}
{% endhighlight %}

To support the sending of realtime device orientation data from the client to the server, I needed to use sockets. Despite the fact that I had limited experience with sockets in the past, the Flask extension Flask-SocketIO made it easy to get started with sockets.
